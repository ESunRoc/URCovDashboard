"0","knitr::opts_chunk$set(echo = TRUE)"
"0","library(readxl)"
"0","library(tidyverse)"
"0","library(zoo)"
"0","library(RcppRoll)"
"0","library(gridExtra)"
"0","library(grid)"
"0","library(plotly)"
"0","library(htmlwidgets)"
"0","library(flexdashboard)"
"0","data <- read_xlsx(""covdata.xlsx"")"
"1",""
"1","-"
"1",""
"1","/"
"1","                                                                                                                                           "
"1",""
"0","data$daily.prate <- ifelse(data$Tests == 0, 0, data$Positive/data$Tests)"
"0","data$totcases <- cumsum(data$Positive)"
"0","data$tottests <- cumsum(data$Tests)"
"0","data$rolltests <- rollmean(data$Tests, k=7, fill=F, align=""right"")"
"0","data$rollpos <- rollmean(data$Positive, k=7, fill=F, align=""right"")"
"0","data$rolldaily.prate <- rollmean(data$daily.prate, k=7, fill=NA, align=""right"")"
"0","n.colfunc <- function(df, n=7, func){"
"0","  aggregate(x = df,"
"0","            by = list(gl(ceiling(nrow(df)/n), n)[1:nrow(df)]),"
"0","            FUN = func)"
"0","}"
"0","twoweeksavg <- n.colfunc(data[2:4], 14, mean)"
"0","oneweekavg <- n.colfunc(data[2:4], 7, mean)"
"0","twoweekssum <- n.colfunc(data[2:4], 14, sum)"
"0","oneweeksum <- n.colfunc(data[2:4], 7, sum)"
"0","cumlcases <- ggplot(data, aes(x = Date, y = totcases)) +"
"0","              geom_line() +"
"0","              scale_y_continuous(breaks=seq(0, max(data$totcases)+5 ,5)) +  "
"0","              labs(x = ""Date"", y = ""Total Cases (to date)"", title = ""Cumulative cases as a function of time"")"
"0","cc <- ggplotly(cumlcases)"
"0","GAM.cumlcases <- ggplot(data, aes(x = Date, y = totcases)) +"
"0","                  geom_smooth(method = ""gam"", size = 1) +"
"0","                  scale_y_continuous(breaks=seq(0, max(data$totcases)+5 ,5)) + "
"0","                  labs(x = ""Date"", y = ""Total Cases (to date)"", title = ""Cumulative cases as a function of time"")"
"0","GAM.cc <- ggplotly(GAM.cumlcases)"
"0","cumltests <- ggplot(data, aes(x = Date, y = tottests)) +"
"0","              geom_line() +"
"0","              labs(x = ""Date"", y = ""Number of Tests"", title = ""Cumulative Testing as a function of time"")"
"0","ct <- ggplotly(cumltests)"
"0","GAM.cumltests <- ggplot(data, aes(x = Date, y = tottests)) +"
"0","                  geom_smooth(method = ""gam"", size = 1) +"
"0","                  labs(x = ""Date"", y=""Number of Tests"", title = ""Cumulative Testing as a function of time"")"
"0","GAM.ct <- ggplotly(GAM.cumltests)"
"0","dailyposrate <- ggplot(data, aes(x = Date, y = daily.prate)) +"
"0","                geom_line() + "
"0","                labs(x = ""Date"", y = ""Positivity Rate"", title = ""Daily positivity rate"","
"0","                     subtitle = ""Aligned right"")"
"0","dpr <- ggplotly(dailyposrate)"
"0","GAM.dailyposrate <- ggplot(data, aes(x = Date, y = daily.prate)) +"
"0","                    geom_smooth(method = ""gam"", size = 1) + "
"0","                    labs(x = ""Date"", y = ""Positivity Rate"", title = ""Daily positivity rate"","
"0","                         subtitle = ""Aligned right"")"
"0","GAM.dpr <- ggplotly(GAM.dailyposrate)"
"0","rollposrate <- ggplot(data, aes(x = Date, y = rolldaily.prate)) +"
"0","                geom_line() + "
"0","                labs(x = ""Date"", y = ""Positivity Rate"", title = ""7 day rolling positivity rate"","
"0","                     subtitle = ""Aligned right"")"
"0","rpr <- ggplotly(rollposrate)"
"0","GAM.rollposrate <- ggplot(data, aes(x = Date, y = rolldaily.prate)) +"
"0","                    geom_smooth(method = ""gam"", size = 1) + "
"0","                    labs(x = ""Date"", y = ""Positivity Rate"", title = ""7 day rolling positivity rate"","
"0","                         subtitle = ""Aligned right"")"
"0","GAM.rpr <- ggplotly(GAM.rollposrate)"
"0","rolltestsgraph <- ggplot(data, aes(x=Date, y=rolltests)) + "
"0","                    geom_line()+"
"0","                    labs(x=""Date"", y=""Tests Conducted"", title = ""7 day rolling tests per day"","
"0","                         subtitle = ""Aligned Right"")"
"0","rtg <- ggplotly(rolltestsgraph)"
"0","GAM.rolltestsgraph <- ggplot(data, aes(x=Date, y=rolltests)) + "
"0","                        geom_smooth(method = ""gam"", size = 1) +"
"0","                        labs(x=""Date"", y=""Tests Conducted"", title = ""7 day rolling tests per day"","
"0","                             subtitle = ""Aligned Right"")"
"0","GAM.rtg <- ggplotly(GAM.rolltestsgraph)"
"0","casesperday <- ggplot(data, aes(x=Date, y=Positive)) + "
"0","                geom_line()+"
"0","                labs(x = ""Date"", y = ""Cases"", title = ""New cases per day"")"
"0","cpd <- ggplotly(casesperday)"
"0","GAM.casesperday <- ggplot(data, aes(x=Date, y=Positive)) + "
"0","                    geom_smooth()+"
"0","                    labs(x = ""Date"", y = ""Cases"", title = ""New cases per day"")"
"0","GAM.cpd <- ggplotly(GAM.casesperday)"
"0","testsperday <- ggplot(data, aes(x=Date, y=Tests)) + "
"0","                geom_line()+"
"0","                labs(x = ""Date"", y = ""Tests"", title = ""Tests per day"")"
"0","tpd <- ggplotly(testsperday)"
"0","GAM.testsperday <- ggplot(data, aes(x=Date, y=Tests)) + "
"0","                    geom_smooth(method = ""gam"", size=1)+"
"0","                    labs(x = ""Date"", y = ""Tests"", title = ""Tests per day"")"
"0","GAM.tpd <- ggplotly(GAM.testsperday)"
"0","oneweek.avgtests <- ggplot(oneweekavg, aes(x=Group.1, y=Tests, group=1)) +"
"0","                      geom_line() + "
"0","                      labs(x=""Weeks since August 1"", title=""Average Tests Over Time Period"", "
"0","                           subtitle = ""Temporal mean, t=7"")"
"0","owat <- ggplotly(oneweek.avgtests)"
"0","twoweeks.avgtests <- ggplot(twoweeksavg, aes(x=Group.1, y=Tests, group=1)) +"
"0","                      geom_line() + "
"0","                      labs(x=""Fortnights since August 1"", title=""Average Tests Over Time Period"", "
"0","                           subtitle = ""Temporal mean, t=14"")"
"0","twsat <- ggplotly(twoweeks.avgtests)"
"0","oneweek.sumtests <- ggplot(oneweeksum, aes(x=Group.1, y=Tests, group=1)) +"
"0","                      geom_line() + "
"0","                      labs(x=""Weeks since August 1"", title=""Cumulative Tests Time Period"")"
"0","owst <- ggplotly(oneweek.sumtests)"
"0","  "
"0","twoweeks.sumtests <- ggplot(twoweekssum, aes(x=Group.1, y=Tests, group=1)) +"
"0","                      geom_line() + "
"0","                      labs(x=""Fortnights since August 1"", title=""Cumulative Tests Time Period"")"
"0","twst <- ggplotly(twoweeks.sumtests)"
